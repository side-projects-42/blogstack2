{"expireTime":9007200914465209000,"key":"transformer-remark-markdown-html-ast-0e5420366b898c8f4e3cec6e4e579362--","val":{"type":"root","children":[{"type":"element","tagName":"h1","properties":{},"children":[{"type":"text","value":"Fetch API","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":12,"offset":12}}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":12,"offset":12}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"So far, we know quite a bit about ","position":{"start":{"line":4,"column":1,"offset":14},"end":{"line":4,"column":35,"offset":48}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"fetch"}],"position":{"start":{"line":4,"column":35,"offset":48},"end":{"line":4,"column":42,"offset":55}}},{"type":"text","value":".","position":{"start":{"line":4,"column":42,"offset":55},"end":{"line":4,"column":43,"offset":56}}}],"position":{"start":{"line":4,"column":1,"offset":14},"end":{"line":4,"column":43,"offset":56}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Let's see the rest of API, to cover all its abilities.","position":{"start":{"line":6,"column":1,"offset":58},"end":{"line":6,"column":55,"offset":112}}}],"position":{"start":{"line":6,"column":1,"offset":58},"end":{"line":6,"column":55,"offset":112}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Please note: most of these options are used rarely. You may skip this chapter and still use `fetch` well.\n\nStill, it's good to know what `fetch` can do, so if the need arises, you can return and read the details.\n"}],"position":{"start":{"line":8,"column":1,"offset":114},"end":{"line":12,"column":4,"offset":338}}}],"position":{"start":{"line":8,"column":1,"offset":114},"end":{"line":12,"column":4,"offset":338}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Here's the full list of all possible ","position":{"start":{"line":14,"column":1,"offset":340},"end":{"line":14,"column":38,"offset":377}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"fetch"}],"position":{"start":{"line":14,"column":38,"offset":377},"end":{"line":14,"column":45,"offset":384}}},{"type":"text","value":" options with their default values (alternatives in comments):","position":{"start":{"line":14,"column":45,"offset":384},"end":{"line":14,"column":107,"offset":446}}}],"position":{"start":{"line":14,"column":1,"offset":340},"end":{"line":14,"column":107,"offset":446}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-js"]},"children":[{"type":"text","value":"//\nlet promise = fetch(url, {\n  method: \"GET\", // POST, PUT, DELETE, etc.\n  headers: {\n    // the content type header value is usually auto-set\n    // depending on the request body\n    \"Content-Type\": \"text/plain;charset=UTF-8\"\n  },\n  body: undefined // string, FormData, Blob, BufferSource, or URLSearchParams\n  referrer: \"about:client\", // or \"\" to send no Referer header,\n  // or an url from the current origin\n  referrerPolicy: \"no-referrer-when-downgrade\", // no-referrer, origin, same-origin...\n  mode: \"cors\", // same-origin, no-cors\n  credentials: \"same-origin\", // omit, include\n  cache: \"default\", // no-store, reload, no-cache, force-cache, or only-if-cached\n  redirect: \"follow\", // manual, error\n  integrity: \"\", // a hash, like \"sha256-abcdef1234567890\"\n  keepalive: false, // true\n  signal: undefined, // AbortController to abort request\n  window: window // null\n});\n"}],"position":{"start":{"line":16,"column":1,"offset":448},"end":{"line":38,"column":4,"offset":1339}}}],"position":{"start":{"line":16,"column":1,"offset":448},"end":{"line":38,"column":4,"offset":1339}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"An impressive list, right?","position":{"start":{"line":40,"column":1,"offset":1341},"end":{"line":40,"column":27,"offset":1367}}}],"position":{"start":{"line":40,"column":1,"offset":1341},"end":{"line":40,"column":27,"offset":1367}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"We fully covered ","position":{"start":{"line":42,"column":1,"offset":1369},"end":{"line":42,"column":18,"offset":1386}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"method"}],"position":{"start":{"line":42,"column":18,"offset":1386},"end":{"line":42,"column":26,"offset":1394}}},{"type":"text","value":", ","position":{"start":{"line":42,"column":26,"offset":1394},"end":{"line":42,"column":28,"offset":1396}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"headers"}],"position":{"start":{"line":42,"column":28,"offset":1396},"end":{"line":42,"column":37,"offset":1405}}},{"type":"text","value":" and ","position":{"start":{"line":42,"column":37,"offset":1405},"end":{"line":42,"column":42,"offset":1410}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"body"}],"position":{"start":{"line":42,"column":42,"offset":1410},"end":{"line":42,"column":48,"offset":1416}}},{"type":"text","value":" in the chapter <info:fetch>.","position":{"start":{"line":42,"column":48,"offset":1416},"end":{"line":42,"column":77,"offset":1445}}}],"position":{"start":{"line":42,"column":1,"offset":1369},"end":{"line":42,"column":77,"offset":1445}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The ","position":{"start":{"line":44,"column":1,"offset":1447},"end":{"line":44,"column":5,"offset":1451}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"signal"}],"position":{"start":{"line":44,"column":5,"offset":1451},"end":{"line":44,"column":13,"offset":1459}}},{"type":"text","value":" option is covered in <info:fetch-abort>.","position":{"start":{"line":44,"column":13,"offset":1459},"end":{"line":44,"column":54,"offset":1500}}}],"position":{"start":{"line":44,"column":1,"offset":1447},"end":{"line":44,"column":54,"offset":1500}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Now let's explore the remaining capabilities.","position":{"start":{"line":46,"column":1,"offset":1502},"end":{"line":46,"column":46,"offset":1547}}}],"position":{"start":{"line":46,"column":1,"offset":1502},"end":{"line":46,"column":46,"offset":1547}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"referrer, referrerPolicy","position":{"start":{"line":48,"column":4,"offset":1552},"end":{"line":48,"column":28,"offset":1576}}}],"position":{"start":{"line":48,"column":1,"offset":1549},"end":{"line":48,"column":28,"offset":1576}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"These options govern how ","position":{"start":{"line":50,"column":1,"offset":1578},"end":{"line":50,"column":26,"offset":1603}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"fetch"}],"position":{"start":{"line":50,"column":26,"offset":1603},"end":{"line":50,"column":33,"offset":1610}}},{"type":"text","value":" sets the HTTP ","position":{"start":{"line":50,"column":33,"offset":1610},"end":{"line":50,"column":48,"offset":1625}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"Referer"}],"position":{"start":{"line":50,"column":48,"offset":1625},"end":{"line":50,"column":57,"offset":1634}}},{"type":"text","value":" header.","position":{"start":{"line":50,"column":57,"offset":1634},"end":{"line":50,"column":65,"offset":1642}}}],"position":{"start":{"line":50,"column":1,"offset":1578},"end":{"line":50,"column":65,"offset":1642}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Usually that header is set automatically and contains the url of the page that made the request. In most scenarios, it's not important at all, sometimes, for security purposes, it makes sense to remove or shorten it.","position":{"start":{"line":52,"column":1,"offset":1644},"end":{"line":52,"column":217,"offset":1860}}}],"position":{"start":{"line":52,"column":1,"offset":1644},"end":{"line":52,"column":217,"offset":1860}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"The ","position":{"start":{"line":54,"column":3,"offset":1864},"end":{"line":54,"column":7,"offset":1868}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"referrer"}],"position":{"start":{"line":54,"column":7,"offset":1868},"end":{"line":54,"column":17,"offset":1878}}},{"type":"text","value":" option allows to set any ","position":{"start":{"line":54,"column":17,"offset":1878},"end":{"line":54,"column":43,"offset":1904}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"Referer"}],"position":{"start":{"line":54,"column":43,"offset":1904},"end":{"line":54,"column":52,"offset":1913}}},{"type":"text","value":" (within the current origin) or remove it.","position":{"start":{"line":54,"column":52,"offset":1913},"end":{"line":54,"column":94,"offset":1955}}}],"position":{"start":{"line":54,"column":1,"offset":1862},"end":{"line":54,"column":96,"offset":1957}}}],"position":{"start":{"line":54,"column":1,"offset":1862},"end":{"line":54,"column":96,"offset":1957}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"To send no referer, set an empty string:","position":{"start":{"line":56,"column":1,"offset":1959},"end":{"line":56,"column":41,"offset":1999}}}],"position":{"start":{"line":56,"column":1,"offset":1959},"end":{"line":56,"column":41,"offset":1999}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-js"]},"children":[{"type":"text","value":"//\nfetch('/page', {\n*!*\n  referrer: \"\" // no Referer header\n*/!*\n});\n"}],"position":{"start":{"line":58,"column":1,"offset":2001},"end":{"line":65,"column":4,"offset":2079}}}],"position":{"start":{"line":58,"column":1,"offset":2001},"end":{"line":65,"column":4,"offset":2079}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"To set another url within the current origin:","position":{"start":{"line":67,"column":1,"offset":2081},"end":{"line":67,"column":46,"offset":2126}}}],"position":{"start":{"line":67,"column":1,"offset":2081},"end":{"line":67,"column":46,"offset":2126}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-js"]},"children":[{"type":"text","value":"//\nfetch('/page', {\n  // assuming we're on https://javascript.info\n  // we can set any Referer header, but only within the current origin\n*!*\n  referrer: \"https://javascript.info/anotherpage\"\n*/!*\n});\n"}],"position":{"start":{"line":69,"column":1,"offset":2128},"end":{"line":78,"column":4,"offset":2338}}}],"position":{"start":{"line":69,"column":1,"offset":2128},"end":{"line":78,"column":4,"offset":2338}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"The ","position":{"start":{"line":80,"column":3,"offset":2342},"end":{"line":80,"column":7,"offset":2346}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"referrerPolicy"}],"position":{"start":{"line":80,"column":7,"offset":2346},"end":{"line":80,"column":23,"offset":2362}}},{"type":"text","value":" option sets general rules for ","position":{"start":{"line":80,"column":23,"offset":2362},"end":{"line":80,"column":54,"offset":2393}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"Referer"}],"position":{"start":{"line":80,"column":54,"offset":2393},"end":{"line":80,"column":63,"offset":2402}}},{"type":"text","value":".","position":{"start":{"line":80,"column":63,"offset":2402},"end":{"line":80,"column":64,"offset":2403}}}],"position":{"start":{"line":80,"column":1,"offset":2340},"end":{"line":80,"column":66,"offset":2405}}}],"position":{"start":{"line":80,"column":1,"offset":2340},"end":{"line":80,"column":66,"offset":2405}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Requests are split into 3 types:","position":{"start":{"line":82,"column":1,"offset":2407},"end":{"line":82,"column":33,"offset":2439}}}],"position":{"start":{"line":82,"column":1,"offset":2407},"end":{"line":82,"column":33,"offset":2439}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Request to the same origin.","position":{"start":{"line":84,"column":4,"offset":2444},"end":{"line":84,"column":31,"offset":2471}}}],"position":{"start":{"line":84,"column":1,"offset":2441},"end":{"line":84,"column":31,"offset":2471}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Request to another origin.","position":{"start":{"line":85,"column":4,"offset":2475},"end":{"line":85,"column":30,"offset":2501}}}],"position":{"start":{"line":85,"column":1,"offset":2472},"end":{"line":85,"column":30,"offset":2501}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Request from HTTPS to HTTP (from safe to unsafe protocol).","position":{"start":{"line":86,"column":4,"offset":2505},"end":{"line":86,"column":62,"offset":2563}}}],"position":{"start":{"line":86,"column":1,"offset":2502},"end":{"line":86,"column":62,"offset":2563}}},{"type":"text","value":"\n"}],"position":{"start":{"line":84,"column":1,"offset":2441},"end":{"line":86,"column":62,"offset":2563}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Unlike the ","position":{"start":{"line":88,"column":1,"offset":2565},"end":{"line":88,"column":12,"offset":2576}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"referrer"}],"position":{"start":{"line":88,"column":12,"offset":2576},"end":{"line":88,"column":22,"offset":2586}}},{"type":"text","value":" option that allows to set the exact ","position":{"start":{"line":88,"column":22,"offset":2586},"end":{"line":88,"column":59,"offset":2623}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"Referer"}],"position":{"start":{"line":88,"column":59,"offset":2623},"end":{"line":88,"column":68,"offset":2632}}},{"type":"text","value":" value, ","position":{"start":{"line":88,"column":68,"offset":2632},"end":{"line":88,"column":76,"offset":2640}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"referrerPolicy"}],"position":{"start":{"line":88,"column":76,"offset":2640},"end":{"line":88,"column":92,"offset":2656}}},{"type":"text","value":" tells the browser general rules for each request type.","position":{"start":{"line":88,"column":92,"offset":2656},"end":{"line":88,"column":147,"offset":2711}}}],"position":{"start":{"line":88,"column":1,"offset":2565},"end":{"line":88,"column":147,"offset":2711}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Possible values are described in the ","position":{"start":{"line":90,"column":1,"offset":2713},"end":{"line":90,"column":38,"offset":2750}}},{"type":"element","tagName":"a","properties":{"href":"https://w3c.github.io/webappsec-referrer-policy/"},"children":[{"type":"text","value":"Referrer Policy specification","position":{"start":{"line":90,"column":39,"offset":2751},"end":{"line":90,"column":68,"offset":2780}}}],"position":{"start":{"line":90,"column":38,"offset":2750},"end":{"line":90,"column":119,"offset":2831}}},{"type":"text","value":":","position":{"start":{"line":90,"column":119,"offset":2831},"end":{"line":90,"column":120,"offset":2832}}}],"position":{"start":{"line":90,"column":1,"offset":2713},"end":{"line":90,"column":120,"offset":2832}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"\"no-referrer-when-downgrade\""}],"position":{"start":{"line":92,"column":7,"offset":2840},"end":{"line":92,"column":37,"offset":2870}}}],"position":{"start":{"line":92,"column":5,"offset":2838},"end":{"line":92,"column":39,"offset":2872}}},{"type":"text","value":" -- the default value: full ","position":{"start":{"line":92,"column":39,"offset":2872},"end":{"line":92,"column":67,"offset":2900}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"Referer"}],"position":{"start":{"line":92,"column":67,"offset":2900},"end":{"line":92,"column":76,"offset":2909}}},{"type":"text","value":" is always sent, unless we send a request from HTTPS to HTTP (to the less secure protocol).","position":{"start":{"line":92,"column":76,"offset":2909},"end":{"line":92,"column":167,"offset":3000}}}],"position":{"start":{"line":92,"column":1,"offset":2834},"end":{"line":92,"column":167,"offset":3000}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"\"no-referrer\""}],"position":{"start":{"line":93,"column":7,"offset":3007},"end":{"line":93,"column":22,"offset":3022}}}],"position":{"start":{"line":93,"column":5,"offset":3005},"end":{"line":93,"column":24,"offset":3024}}},{"type":"text","value":" -- never send ","position":{"start":{"line":93,"column":24,"offset":3024},"end":{"line":93,"column":39,"offset":3039}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"Referer"}],"position":{"start":{"line":93,"column":39,"offset":3039},"end":{"line":93,"column":48,"offset":3048}}},{"type":"text","value":".","position":{"start":{"line":93,"column":48,"offset":3048},"end":{"line":93,"column":49,"offset":3049}}}],"position":{"start":{"line":93,"column":1,"offset":3001},"end":{"line":93,"column":49,"offset":3049}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"\"origin\""}],"position":{"start":{"line":94,"column":7,"offset":3056},"end":{"line":94,"column":17,"offset":3066}}}],"position":{"start":{"line":94,"column":5,"offset":3054},"end":{"line":94,"column":19,"offset":3068}}},{"type":"text","value":" -- only send the origin in ","position":{"start":{"line":94,"column":19,"offset":3068},"end":{"line":94,"column":47,"offset":3096}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"Referer"}],"position":{"start":{"line":94,"column":47,"offset":3096},"end":{"line":94,"column":56,"offset":3105}}},{"type":"text","value":", not the full page URL, e.g. only ","position":{"start":{"line":94,"column":56,"offset":3105},"end":{"line":94,"column":91,"offset":3140}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"http://site.com"}],"position":{"start":{"line":94,"column":91,"offset":3140},"end":{"line":94,"column":108,"offset":3157}}},{"type":"text","value":" instead of ","position":{"start":{"line":94,"column":108,"offset":3157},"end":{"line":94,"column":120,"offset":3169}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"http://site.com/path"}],"position":{"start":{"line":94,"column":120,"offset":3169},"end":{"line":94,"column":142,"offset":3191}}},{"type":"text","value":".","position":{"start":{"line":94,"column":142,"offset":3191},"end":{"line":94,"column":143,"offset":3192}}}],"position":{"start":{"line":94,"column":1,"offset":3050},"end":{"line":94,"column":143,"offset":3192}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"\"origin-when-cross-origin\""}],"position":{"start":{"line":95,"column":7,"offset":3199},"end":{"line":95,"column":35,"offset":3227}}}],"position":{"start":{"line":95,"column":5,"offset":3197},"end":{"line":95,"column":37,"offset":3229}}},{"type":"text","value":" -- send the full ","position":{"start":{"line":95,"column":37,"offset":3229},"end":{"line":95,"column":55,"offset":3247}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"Referer"}],"position":{"start":{"line":95,"column":55,"offset":3247},"end":{"line":95,"column":64,"offset":3256}}},{"type":"text","value":" to the same origin, but only the origin part for cross-origin requests (as above).","position":{"start":{"line":95,"column":64,"offset":3256},"end":{"line":95,"column":147,"offset":3339}}}],"position":{"start":{"line":95,"column":1,"offset":3193},"end":{"line":95,"column":147,"offset":3339}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"\"same-origin\""}],"position":{"start":{"line":96,"column":7,"offset":3346},"end":{"line":96,"column":22,"offset":3361}}}],"position":{"start":{"line":96,"column":5,"offset":3344},"end":{"line":96,"column":24,"offset":3363}}},{"type":"text","value":" -- send the full ","position":{"start":{"line":96,"column":24,"offset":3363},"end":{"line":96,"column":42,"offset":3381}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"Referer"}],"position":{"start":{"line":96,"column":42,"offset":3381},"end":{"line":96,"column":51,"offset":3390}}},{"type":"text","value":" to the same origin, but no ","position":{"start":{"line":96,"column":51,"offset":3390},"end":{"line":96,"column":79,"offset":3418}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"Referer"}],"position":{"start":{"line":96,"column":79,"offset":3418},"end":{"line":96,"column":88,"offset":3427}}},{"type":"text","value":" for cross-origin requests.","position":{"start":{"line":96,"column":88,"offset":3427},"end":{"line":96,"column":115,"offset":3454}}}],"position":{"start":{"line":96,"column":1,"offset":3340},"end":{"line":96,"column":115,"offset":3454}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"\"strict-origin\""}],"position":{"start":{"line":97,"column":7,"offset":3461},"end":{"line":97,"column":24,"offset":3478}}}],"position":{"start":{"line":97,"column":5,"offset":3459},"end":{"line":97,"column":26,"offset":3480}}},{"type":"text","value":" -- send only the origin, not the ","position":{"start":{"line":97,"column":26,"offset":3480},"end":{"line":97,"column":60,"offset":3514}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"Referer"}],"position":{"start":{"line":97,"column":60,"offset":3514},"end":{"line":97,"column":69,"offset":3523}}},{"type":"text","value":" for HTTPS→HTTP requests.","position":{"start":{"line":97,"column":69,"offset":3523},"end":{"line":97,"column":94,"offset":3548}}}],"position":{"start":{"line":97,"column":1,"offset":3455},"end":{"line":97,"column":94,"offset":3548}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"\"strict-origin-when-cross-origin\""}],"position":{"start":{"line":98,"column":7,"offset":3555},"end":{"line":98,"column":42,"offset":3590}}}],"position":{"start":{"line":98,"column":5,"offset":3553},"end":{"line":98,"column":44,"offset":3592}}},{"type":"text","value":" -- for same-origin send the full ","position":{"start":{"line":98,"column":44,"offset":3592},"end":{"line":98,"column":78,"offset":3626}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"Referer"}],"position":{"start":{"line":98,"column":78,"offset":3626},"end":{"line":98,"column":87,"offset":3635}}},{"type":"text","value":", for cross-origin send only the origin, unless it's HTTPS→HTTP request, then send nothing.","position":{"start":{"line":98,"column":87,"offset":3635},"end":{"line":98,"column":178,"offset":3726}}}],"position":{"start":{"line":98,"column":1,"offset":3549},"end":{"line":98,"column":178,"offset":3726}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"\"unsafe-url\""}],"position":{"start":{"line":99,"column":7,"offset":3733},"end":{"line":99,"column":21,"offset":3747}}}],"position":{"start":{"line":99,"column":5,"offset":3731},"end":{"line":99,"column":23,"offset":3749}}},{"type":"text","value":" -- always send the full url in ","position":{"start":{"line":99,"column":23,"offset":3749},"end":{"line":99,"column":55,"offset":3781}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"Referer"}],"position":{"start":{"line":99,"column":55,"offset":3781},"end":{"line":99,"column":64,"offset":3790}}},{"type":"text","value":", even for HTTPS→HTTP requests.","position":{"start":{"line":99,"column":64,"offset":3790},"end":{"line":99,"column":95,"offset":3821}}}],"position":{"start":{"line":99,"column":1,"offset":3727},"end":{"line":99,"column":95,"offset":3821}}},{"type":"text","value":"\n"}],"position":{"start":{"line":92,"column":1,"offset":2834},"end":{"line":99,"column":95,"offset":3821}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Here's a table with all combinations:","position":{"start":{"line":101,"column":1,"offset":3823},"end":{"line":101,"column":38,"offset":3860}}}],"position":{"start":{"line":101,"column":1,"offset":3823},"end":{"line":101,"column":38,"offset":3860}}},{"type":"text","value":"\n"},{"type":"element","tagName":"table","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"thead","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"th","properties":{"align":null},"children":[{"type":"text","value":"Value","position":{"start":{"line":103,"column":3,"offset":3864},"end":{"line":103,"column":8,"offset":3869}}}],"position":{"start":{"line":103,"column":3,"offset":3864},"end":{"line":103,"column":51,"offset":3912}}},{"type":"text","value":"\n"},{"type":"element","tagName":"th","properties":{"align":null},"children":[{"type":"text","value":"To same origin","position":{"start":{"line":103,"column":54,"offset":3915},"end":{"line":103,"column":68,"offset":3929}}}],"position":{"start":{"line":103,"column":54,"offset":3915},"end":{"line":103,"column":68,"offset":3929}}},{"type":"text","value":"\n"},{"type":"element","tagName":"th","properties":{"align":null},"children":[{"type":"text","value":"To another origin","position":{"start":{"line":103,"column":71,"offset":3932},"end":{"line":103,"column":88,"offset":3949}}}],"position":{"start":{"line":103,"column":71,"offset":3932},"end":{"line":103,"column":88,"offset":3949}}},{"type":"text","value":"\n"},{"type":"element","tagName":"th","properties":{"align":null},"children":[{"type":"text","value":"HTTPS→HTTP","position":{"start":{"line":103,"column":91,"offset":3952},"end":{"line":103,"column":101,"offset":3962}}}],"position":{"start":{"line":103,"column":91,"offset":3952},"end":{"line":103,"column":101,"offset":3962}}},{"type":"text","value":"\n"}],"position":{"start":{"line":103,"column":1,"offset":3862},"end":{"line":103,"column":103,"offset":3964}}},{"type":"text","value":"\n"}],"position":{"start":{"line":103,"column":1,"offset":3862},"end":{"line":103,"column":103,"offset":3964}}},{"type":"text","value":"\n"},{"type":"element","tagName":"tbody","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"td","properties":{"align":null},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"\"no-referrer\""}],"position":{"start":{"line":105,"column":3,"offset":4070},"end":{"line":105,"column":18,"offset":4085}}}],"position":{"start":{"line":105,"column":3,"offset":4070},"end":{"line":105,"column":51,"offset":4118}}},{"type":"text","value":"\n"},{"type":"element","tagName":"td","properties":{"align":null},"children":[{"type":"text","value":"-","position":{"start":{"line":105,"column":54,"offset":4121},"end":{"line":105,"column":55,"offset":4122}}}],"position":{"start":{"line":105,"column":54,"offset":4121},"end":{"line":105,"column":68,"offset":4135}}},{"type":"text","value":"\n"},{"type":"element","tagName":"td","properties":{"align":null},"children":[{"type":"text","value":"-","position":{"start":{"line":105,"column":71,"offset":4138},"end":{"line":105,"column":72,"offset":4139}}}],"position":{"start":{"line":105,"column":71,"offset":4138},"end":{"line":105,"column":88,"offset":4155}}},{"type":"text","value":"\n"},{"type":"element","tagName":"td","properties":{"align":null},"children":[{"type":"text","value":"-","position":{"start":{"line":105,"column":91,"offset":4158},"end":{"line":105,"column":92,"offset":4159}}}],"position":{"start":{"line":105,"column":91,"offset":4158},"end":{"line":105,"column":101,"offset":4168}}},{"type":"text","value":"\n"}],"position":{"start":{"line":105,"column":1,"offset":4068},"end":{"line":105,"column":103,"offset":4170}}},{"type":"text","value":"\n"},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"td","properties":{"align":null},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"\"no-referrer-when-downgrade\""}],"position":{"start":{"line":106,"column":3,"offset":4173},"end":{"line":106,"column":33,"offset":4203}}},{"type":"text","value":" or ","position":{"start":{"line":106,"column":33,"offset":4203},"end":{"line":106,"column":37,"offset":4207}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"\"\""}],"position":{"start":{"line":106,"column":37,"offset":4207},"end":{"line":106,"column":41,"offset":4211}}},{"type":"text","value":" (default)","position":{"start":{"line":106,"column":41,"offset":4211},"end":{"line":106,"column":51,"offset":4221}}}],"position":{"start":{"line":106,"column":3,"offset":4173},"end":{"line":106,"column":51,"offset":4221}}},{"type":"text","value":"\n"},{"type":"element","tagName":"td","properties":{"align":null},"children":[{"type":"text","value":"full","position":{"start":{"line":106,"column":54,"offset":4224},"end":{"line":106,"column":58,"offset":4228}}}],"position":{"start":{"line":106,"column":54,"offset":4224},"end":{"line":106,"column":68,"offset":4238}}},{"type":"text","value":"\n"},{"type":"element","tagName":"td","properties":{"align":null},"children":[{"type":"text","value":"full","position":{"start":{"line":106,"column":71,"offset":4241},"end":{"line":106,"column":75,"offset":4245}}}],"position":{"start":{"line":106,"column":71,"offset":4241},"end":{"line":106,"column":88,"offset":4258}}},{"type":"text","value":"\n"},{"type":"element","tagName":"td","properties":{"align":null},"children":[{"type":"text","value":"-","position":{"start":{"line":106,"column":91,"offset":4261},"end":{"line":106,"column":92,"offset":4262}}}],"position":{"start":{"line":106,"column":91,"offset":4261},"end":{"line":106,"column":101,"offset":4271}}},{"type":"text","value":"\n"}],"position":{"start":{"line":106,"column":1,"offset":4171},"end":{"line":106,"column":103,"offset":4273}}},{"type":"text","value":"\n"},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"td","properties":{"align":null},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"\"origin\""}],"position":{"start":{"line":107,"column":3,"offset":4276},"end":{"line":107,"column":13,"offset":4286}}}],"position":{"start":{"line":107,"column":3,"offset":4276},"end":{"line":107,"column":51,"offset":4324}}},{"type":"text","value":"\n"},{"type":"element","tagName":"td","properties":{"align":null},"children":[{"type":"text","value":"origin","position":{"start":{"line":107,"column":54,"offset":4327},"end":{"line":107,"column":60,"offset":4333}}}],"position":{"start":{"line":107,"column":54,"offset":4327},"end":{"line":107,"column":68,"offset":4341}}},{"type":"text","value":"\n"},{"type":"element","tagName":"td","properties":{"align":null},"children":[{"type":"text","value":"origin","position":{"start":{"line":107,"column":71,"offset":4344},"end":{"line":107,"column":77,"offset":4350}}}],"position":{"start":{"line":107,"column":71,"offset":4344},"end":{"line":107,"column":88,"offset":4361}}},{"type":"text","value":"\n"},{"type":"element","tagName":"td","properties":{"align":null},"children":[{"type":"text","value":"origin","position":{"start":{"line":107,"column":91,"offset":4364},"end":{"line":107,"column":97,"offset":4370}}}],"position":{"start":{"line":107,"column":91,"offset":4364},"end":{"line":107,"column":101,"offset":4374}}},{"type":"text","value":"\n"}],"position":{"start":{"line":107,"column":1,"offset":4274},"end":{"line":107,"column":103,"offset":4376}}},{"type":"text","value":"\n"},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"td","properties":{"align":null},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"\"origin-when-cross-origin\""}],"position":{"start":{"line":108,"column":3,"offset":4379},"end":{"line":108,"column":31,"offset":4407}}}],"position":{"start":{"line":108,"column":3,"offset":4379},"end":{"line":108,"column":51,"offset":4427}}},{"type":"text","value":"\n"},{"type":"element","tagName":"td","properties":{"align":null},"children":[{"type":"text","value":"full","position":{"start":{"line":108,"column":54,"offset":4430},"end":{"line":108,"column":58,"offset":4434}}}],"position":{"start":{"line":108,"column":54,"offset":4430},"end":{"line":108,"column":68,"offset":4444}}},{"type":"text","value":"\n"},{"type":"element","tagName":"td","properties":{"align":null},"children":[{"type":"text","value":"origin","position":{"start":{"line":108,"column":71,"offset":4447},"end":{"line":108,"column":77,"offset":4453}}}],"position":{"start":{"line":108,"column":71,"offset":4447},"end":{"line":108,"column":88,"offset":4464}}},{"type":"text","value":"\n"},{"type":"element","tagName":"td","properties":{"align":null},"children":[{"type":"text","value":"origin","position":{"start":{"line":108,"column":91,"offset":4467},"end":{"line":108,"column":97,"offset":4473}}}],"position":{"start":{"line":108,"column":91,"offset":4467},"end":{"line":108,"column":101,"offset":4477}}},{"type":"text","value":"\n"}],"position":{"start":{"line":108,"column":1,"offset":4377},"end":{"line":108,"column":103,"offset":4479}}},{"type":"text","value":"\n"},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"td","properties":{"align":null},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"\"same-origin\""}],"position":{"start":{"line":109,"column":3,"offset":4482},"end":{"line":109,"column":18,"offset":4497}}}],"position":{"start":{"line":109,"column":3,"offset":4482},"end":{"line":109,"column":51,"offset":4530}}},{"type":"text","value":"\n"},{"type":"element","tagName":"td","properties":{"align":null},"children":[{"type":"text","value":"full","position":{"start":{"line":109,"column":54,"offset":4533},"end":{"line":109,"column":58,"offset":4537}}}],"position":{"start":{"line":109,"column":54,"offset":4533},"end":{"line":109,"column":68,"offset":4547}}},{"type":"text","value":"\n"},{"type":"element","tagName":"td","properties":{"align":null},"children":[{"type":"text","value":"-","position":{"start":{"line":109,"column":71,"offset":4550},"end":{"line":109,"column":72,"offset":4551}}}],"position":{"start":{"line":109,"column":71,"offset":4550},"end":{"line":109,"column":88,"offset":4567}}},{"type":"text","value":"\n"},{"type":"element","tagName":"td","properties":{"align":null},"children":[{"type":"text","value":"-","position":{"start":{"line":109,"column":91,"offset":4570},"end":{"line":109,"column":92,"offset":4571}}}],"position":{"start":{"line":109,"column":91,"offset":4570},"end":{"line":109,"column":101,"offset":4580}}},{"type":"text","value":"\n"}],"position":{"start":{"line":109,"column":1,"offset":4480},"end":{"line":109,"column":103,"offset":4582}}},{"type":"text","value":"\n"},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"td","properties":{"align":null},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"\"strict-origin\""}],"position":{"start":{"line":110,"column":3,"offset":4585},"end":{"line":110,"column":20,"offset":4602}}}],"position":{"start":{"line":110,"column":3,"offset":4585},"end":{"line":110,"column":51,"offset":4633}}},{"type":"text","value":"\n"},{"type":"element","tagName":"td","properties":{"align":null},"children":[{"type":"text","value":"origin","position":{"start":{"line":110,"column":54,"offset":4636},"end":{"line":110,"column":60,"offset":4642}}}],"position":{"start":{"line":110,"column":54,"offset":4636},"end":{"line":110,"column":68,"offset":4650}}},{"type":"text","value":"\n"},{"type":"element","tagName":"td","properties":{"align":null},"children":[{"type":"text","value":"origin","position":{"start":{"line":110,"column":71,"offset":4653},"end":{"line":110,"column":77,"offset":4659}}}],"position":{"start":{"line":110,"column":71,"offset":4653},"end":{"line":110,"column":88,"offset":4670}}},{"type":"text","value":"\n"},{"type":"element","tagName":"td","properties":{"align":null},"children":[{"type":"text","value":"-","position":{"start":{"line":110,"column":91,"offset":4673},"end":{"line":110,"column":92,"offset":4674}}}],"position":{"start":{"line":110,"column":91,"offset":4673},"end":{"line":110,"column":101,"offset":4683}}},{"type":"text","value":"\n"}],"position":{"start":{"line":110,"column":1,"offset":4583},"end":{"line":110,"column":103,"offset":4685}}},{"type":"text","value":"\n"},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"td","properties":{"align":null},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"\"strict-origin-when-cross-origin\""}],"position":{"start":{"line":111,"column":3,"offset":4688},"end":{"line":111,"column":38,"offset":4723}}}],"position":{"start":{"line":111,"column":3,"offset":4688},"end":{"line":111,"column":51,"offset":4736}}},{"type":"text","value":"\n"},{"type":"element","tagName":"td","properties":{"align":null},"children":[{"type":"text","value":"full","position":{"start":{"line":111,"column":54,"offset":4739},"end":{"line":111,"column":58,"offset":4743}}}],"position":{"start":{"line":111,"column":54,"offset":4739},"end":{"line":111,"column":68,"offset":4753}}},{"type":"text","value":"\n"},{"type":"element","tagName":"td","properties":{"align":null},"children":[{"type":"text","value":"origin","position":{"start":{"line":111,"column":71,"offset":4756},"end":{"line":111,"column":77,"offset":4762}}}],"position":{"start":{"line":111,"column":71,"offset":4756},"end":{"line":111,"column":88,"offset":4773}}},{"type":"text","value":"\n"},{"type":"element","tagName":"td","properties":{"align":null},"children":[{"type":"text","value":"-","position":{"start":{"line":111,"column":91,"offset":4776},"end":{"line":111,"column":92,"offset":4777}}}],"position":{"start":{"line":111,"column":91,"offset":4776},"end":{"line":111,"column":101,"offset":4786}}},{"type":"text","value":"\n"}],"position":{"start":{"line":111,"column":1,"offset":4686},"end":{"line":111,"column":103,"offset":4788}}},{"type":"text","value":"\n"},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"td","properties":{"align":null},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"\"unsafe-url\""}],"position":{"start":{"line":112,"column":3,"offset":4791},"end":{"line":112,"column":17,"offset":4805}}}],"position":{"start":{"line":112,"column":3,"offset":4791},"end":{"line":112,"column":51,"offset":4839}}},{"type":"text","value":"\n"},{"type":"element","tagName":"td","properties":{"align":null},"children":[{"type":"text","value":"full","position":{"start":{"line":112,"column":54,"offset":4842},"end":{"line":112,"column":58,"offset":4846}}}],"position":{"start":{"line":112,"column":54,"offset":4842},"end":{"line":112,"column":68,"offset":4856}}},{"type":"text","value":"\n"},{"type":"element","tagName":"td","properties":{"align":null},"children":[{"type":"text","value":"full","position":{"start":{"line":112,"column":71,"offset":4859},"end":{"line":112,"column":75,"offset":4863}}}],"position":{"start":{"line":112,"column":71,"offset":4859},"end":{"line":112,"column":88,"offset":4876}}},{"type":"text","value":"\n"},{"type":"element","tagName":"td","properties":{"align":null},"children":[{"type":"text","value":"full","position":{"start":{"line":112,"column":91,"offset":4879},"end":{"line":112,"column":95,"offset":4883}}}],"position":{"start":{"line":112,"column":91,"offset":4879},"end":{"line":112,"column":101,"offset":4889}}},{"type":"text","value":"\n"}],"position":{"start":{"line":112,"column":1,"offset":4789},"end":{"line":112,"column":103,"offset":4891}}},{"type":"text","value":"\n"}],"position":{"start":{"line":105,"column":1,"offset":4068},"end":{"line":112,"column":103,"offset":4891}}},{"type":"text","value":"\n"}],"position":{"start":{"line":103,"column":1,"offset":3862},"end":{"line":112,"column":103,"offset":4891}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Let's say we have an admin zone with a URL structure that shouldn't be known from outside of the site.","position":{"start":{"line":114,"column":1,"offset":4893},"end":{"line":114,"column":103,"offset":4995}}}],"position":{"start":{"line":114,"column":1,"offset":4893},"end":{"line":114,"column":103,"offset":4995}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"If we send a ","position":{"start":{"line":116,"column":1,"offset":4997},"end":{"line":116,"column":14,"offset":5010}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"fetch"}],"position":{"start":{"line":116,"column":14,"offset":5010},"end":{"line":116,"column":21,"offset":5017}}},{"type":"text","value":", then by default it always sends the ","position":{"start":{"line":116,"column":21,"offset":5017},"end":{"line":116,"column":59,"offset":5055}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"Referer"}],"position":{"start":{"line":116,"column":59,"offset":5055},"end":{"line":116,"column":68,"offset":5064}}},{"type":"text","value":" header with the full url of our page (except when we request from HTTPS to HTTP, then no ","position":{"start":{"line":116,"column":68,"offset":5064},"end":{"line":116,"column":158,"offset":5154}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"Referer"}],"position":{"start":{"line":116,"column":158,"offset":5154},"end":{"line":116,"column":167,"offset":5163}}},{"type":"text","value":").","position":{"start":{"line":116,"column":167,"offset":5163},"end":{"line":116,"column":169,"offset":5165}}}],"position":{"start":{"line":116,"column":1,"offset":4997},"end":{"line":116,"column":169,"offset":5165}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"E.g. ","position":{"start":{"line":118,"column":1,"offset":5167},"end":{"line":118,"column":6,"offset":5172}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"Referer: https://javascript.info/admin/secret/paths"}],"position":{"start":{"line":118,"column":6,"offset":5172},"end":{"line":118,"column":59,"offset":5225}}},{"type":"text","value":".","position":{"start":{"line":118,"column":59,"offset":5225},"end":{"line":118,"column":60,"offset":5226}}}],"position":{"start":{"line":118,"column":1,"offset":5167},"end":{"line":118,"column":60,"offset":5226}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"If we'd like other websites know only the origin part, not the URL-path, we can set the option:","position":{"start":{"line":120,"column":1,"offset":5228},"end":{"line":120,"column":96,"offset":5323}}}],"position":{"start":{"line":120,"column":1,"offset":5228},"end":{"line":120,"column":96,"offset":5323}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-js"]},"children":[{"type":"text","value":"//\nfetch('https://another.com/page', {\n    // ...\n    referrerPolicy: 'origin-when-cross-origin' // Referer: https://javascript.info\n});\n"}],"position":{"start":{"line":122,"column":1,"offset":5325},"end":{"line":128,"column":4,"offset":5471}}}],"position":{"start":{"line":122,"column":1,"offset":5325},"end":{"line":128,"column":4,"offset":5471}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"We can put it to all ","position":{"start":{"line":130,"column":1,"offset":5473},"end":{"line":130,"column":22,"offset":5494}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"fetch"}],"position":{"start":{"line":130,"column":22,"offset":5494},"end":{"line":130,"column":29,"offset":5501}}},{"type":"text","value":" calls, maybe integrate into JavaScript library of our project that does all requests and uses ","position":{"start":{"line":130,"column":29,"offset":5501},"end":{"line":130,"column":124,"offset":5596}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"fetch"}],"position":{"start":{"line":130,"column":124,"offset":5596},"end":{"line":130,"column":131,"offset":5603}}},{"type":"text","value":" inside.","position":{"start":{"line":130,"column":131,"offset":5603},"end":{"line":130,"column":139,"offset":5611}}}],"position":{"start":{"line":130,"column":1,"offset":5473},"end":{"line":130,"column":139,"offset":5611}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Its only difference compared to the default behavior is that for requests to another origin ","position":{"start":{"line":132,"column":1,"offset":5613},"end":{"line":132,"column":93,"offset":5705}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"fetch"}],"position":{"start":{"line":132,"column":93,"offset":5705},"end":{"line":132,"column":100,"offset":5712}}},{"type":"text","value":" sends only the origin part of the URL (e.g. ","position":{"start":{"line":132,"column":100,"offset":5712},"end":{"line":132,"column":145,"offset":5757}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"https://javascript.info"}],"position":{"start":{"line":132,"column":145,"offset":5757},"end":{"line":132,"column":170,"offset":5782}}},{"type":"text","value":", without path). For requests to our origin we still get the full ","position":{"start":{"line":132,"column":170,"offset":5782},"end":{"line":132,"column":236,"offset":5848}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"Referer"}],"position":{"start":{"line":132,"column":236,"offset":5848},"end":{"line":132,"column":245,"offset":5857}}},{"type":"text","value":" (maybe useful for debugging purposes).","position":{"start":{"line":132,"column":245,"offset":5857},"end":{"line":132,"column":284,"offset":5896}}}],"position":{"start":{"line":132,"column":1,"offset":5613},"end":{"line":132,"column":284,"offset":5896}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"`","position":{"start":{"line":134,"column":1,"offset":5898},"end":{"line":134,"column":2,"offset":5899}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":""}],"position":{"start":{"line":134,"column":2,"offset":5899},"end":{"line":134,"column":4,"offset":5901}}},{"type":"text","value":"text header=\"Referrer policy is not only for ","position":{"start":{"line":134,"column":4,"offset":5901},"end":{"line":134,"column":49,"offset":5946}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"fetch"}],"position":{"start":{"line":134,"column":49,"offset":5946},"end":{"line":134,"column":56,"offset":5953}}},{"type":"text","value":"\" Referrer policy, described in the ","position":{"start":{"line":134,"column":56,"offset":5953},"end":{"line":134,"column":92,"offset":5989}}},{"type":"element","tagName":"a","properties":{"href":"https://w3c.github.io/webappsec-referrer-policy/"},"children":[{"type":"text","value":"specification","position":{"start":{"line":134,"column":93,"offset":5990},"end":{"line":134,"column":106,"offset":6003}}}],"position":{"start":{"line":134,"column":92,"offset":5989},"end":{"line":134,"column":157,"offset":6054}}},{"type":"text","value":", is not just for ","position":{"start":{"line":134,"column":157,"offset":6054},"end":{"line":134,"column":175,"offset":6072}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"fetch"}],"position":{"start":{"line":134,"column":175,"offset":6072},"end":{"line":134,"column":182,"offset":6079}}},{"type":"text","value":", but more global.","position":{"start":{"line":134,"column":182,"offset":6079},"end":{"line":134,"column":200,"offset":6097}}}],"position":{"start":{"line":134,"column":1,"offset":5898},"end":{"line":134,"column":200,"offset":6097}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"In particular, it's possible to set the default policy for the whole page using the ","position":{"start":{"line":136,"column":1,"offset":6099},"end":{"line":136,"column":85,"offset":6183}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"Referrer-Policy"}],"position":{"start":{"line":136,"column":85,"offset":6183},"end":{"line":136,"column":102,"offset":6200}}},{"type":"text","value":" HTTP header, or per-link, with ","position":{"start":{"line":136,"column":102,"offset":6200},"end":{"line":136,"column":134,"offset":6232}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"<a rel=\"noreferrer\">"}],"position":{"start":{"line":136,"column":134,"offset":6232},"end":{"line":136,"column":156,"offset":6254}}},{"type":"text","value":".","position":{"start":{"line":136,"column":156,"offset":6254},"end":{"line":136,"column":157,"offset":6255}}}],"position":{"start":{"line":136,"column":1,"offset":6099},"end":{"line":136,"column":157,"offset":6255}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"## mode\n\nThe `mode` option is a safe-guard that prevents occasional cross-origin requests:\n\n- **`\"cors\"`** -- the default, cross-origin requests are allowed, as described in <info:fetch-crossorigin>,\n- **`\"same-origin\"`** -- cross-origin requests are forbidden,\n- **`\"no-cors\"`** -- only safe cross-origin requests are allowed.\n\nThis option may be useful when the URL for `fetch` comes from a 3rd-party, and we want a \"power off switch\" to limit cross-origin capabilities.\n\n## credentials\n\nThe `credentials` option specifies whether `fetch` should send cookies and HTTP-Authorization headers with the request.\n\n- **`\"same-origin\"`** -- the default, don't send for cross-origin requests,\n- **`\"include\"`** -- always send, requires `Accept-Control-Allow-Credentials` from cross-origin server in order for JavaScript to access the response, that was covered in the chapter <info:fetch-crossorigin>,\n- **`\"omit\"`** -- never send, even for same-origin requests.\n\n## cache\n\nBy default, `fetch` requests make use of standard HTTP-caching. That is, it respects the `Expires` and `Cache-Control` headers, sends `If-Modified-Since` and so on. Just like regular HTTP-requests do.\n\nThe `cache` options allows to ignore HTTP-cache or fine-tune its usage:\n\n- **`\"default\"`** -- `fetch` uses standard HTTP-cache rules and headers,\n- **`\"no-store\"`** -- totally ignore HTTP-cache, this mode becomes the default if we set a header `If-Modified-Since`, `If-None-Match`, `If-Unmodified-Since`, `If-Match`, or `If-Range`,\n- **`\"reload\"`** -- don't take the result from HTTP-cache (if any), but populate the cache with the response (if the response headers permit this action),\n- **`\"no-cache\"`** -- create a conditional request if there is a cached response, and a normal request otherwise. Populate HTTP-cache with the response,\n- **`\"force-cache\"`** -- use a response from HTTP-cache, even if it's stale. If there's no response in HTTP-cache, make a regular HTTP-request, behave normally,\n- **`\"only-if-cached\"`** -- use a response from HTTP-cache, even if it's stale. If there's no response in HTTP-cache, then error. Only works when `mode` is `\"same-origin\"`.\n\n## redirect\n\nNormally, `fetch` transparently follows HTTP-redirects, like 301, 302 etc.\n\nThe `redirect` option allows to change that:\n\n- **`\"follow\"`** -- the default, follow HTTP-redirects,\n- **`\"error\"`** -- error in case of HTTP-redirect,\n- **`\"manual\"`** -- allows to process HTTP-redirects manually. In case of redirect, we'll get a special response object, with `response.type=\"opaqueredirect\"` and zeroed/empty status and most other properies.\n\n## integrity\n\nThe `integrity` option allows to check if the response matches the known-ahead checksum.\n\nAs described in the [specification](https://w3c.github.io/webappsec-subresource-integrity/), supported hash-functions are SHA-256, SHA-384, and SHA-512, there might be others depending on the browser.\n\nFor example, we're downloading a file, and we know that it's SHA-256 checksum is \"abcdef\" (a real checksum is longer, of course).\n\nWe can put it in the `integrity` option, like this:\n\n```js\n//\nfetch('http://site.com/file', {\n  integrity: 'sha256-abcdef'\n});\n"}],"position":{"start":{"line":138,"column":1,"offset":6257},"end":{"line":196,"column":5,"offset":9428}}}],"position":{"start":{"line":138,"column":1,"offset":6257},"end":{"line":196,"column":5,"offset":9428}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Then ","position":{"start":{"line":198,"column":1,"offset":9430},"end":{"line":198,"column":6,"offset":9435}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"fetch"}],"position":{"start":{"line":198,"column":6,"offset":9435},"end":{"line":198,"column":13,"offset":9442}}},{"type":"text","value":" will calculate SHA-256 on its own and compare it with our string. In case of a mismatch, an error is triggered.","position":{"start":{"line":198,"column":13,"offset":9442},"end":{"line":198,"column":125,"offset":9554}}}],"position":{"start":{"line":198,"column":1,"offset":9430},"end":{"line":198,"column":125,"offset":9554}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"keepalive","position":{"start":{"line":200,"column":4,"offset":9559},"end":{"line":200,"column":13,"offset":9568}}}],"position":{"start":{"line":200,"column":1,"offset":9556},"end":{"line":200,"column":13,"offset":9568}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The ","position":{"start":{"line":202,"column":1,"offset":9570},"end":{"line":202,"column":5,"offset":9574}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"keepalive"}],"position":{"start":{"line":202,"column":5,"offset":9574},"end":{"line":202,"column":16,"offset":9585}}},{"type":"text","value":" option indicates that the request may \"outlive\" the webpage that initiated it.","position":{"start":{"line":202,"column":16,"offset":9585},"end":{"line":202,"column":95,"offset":9664}}}],"position":{"start":{"line":202,"column":1,"offset":9570},"end":{"line":202,"column":95,"offset":9664}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"For example, we gather statistics on how the current visitor uses our page (mouse clicks, page fragments he views), to analyze and improve the user experience.","position":{"start":{"line":204,"column":1,"offset":9666},"end":{"line":204,"column":160,"offset":9825}}}],"position":{"start":{"line":204,"column":1,"offset":9666},"end":{"line":204,"column":160,"offset":9825}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"When the visitor leaves our page -- we'd like to save the data to our server.","position":{"start":{"line":206,"column":1,"offset":9827},"end":{"line":206,"column":78,"offset":9904}}}],"position":{"start":{"line":206,"column":1,"offset":9827},"end":{"line":206,"column":78,"offset":9904}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"We can use the ","position":{"start":{"line":208,"column":1,"offset":9906},"end":{"line":208,"column":16,"offset":9921}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"window.onunload"}],"position":{"start":{"line":208,"column":16,"offset":9921},"end":{"line":208,"column":33,"offset":9938}}},{"type":"text","value":" event for that:","position":{"start":{"line":208,"column":33,"offset":9938},"end":{"line":208,"column":49,"offset":9954}}}],"position":{"start":{"line":208,"column":1,"offset":9906},"end":{"line":208,"column":49,"offset":9954}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-js"]},"children":[{"type":"text","value":"// run\nwindow.onunload = function() {\n  fetch('/analytics', {\n    method: 'POST',\n    body: \"statistics\",\n*!*\n    keepalive: true\n*/!*\n  });\n};\n"}],"position":{"start":{"line":210,"column":1,"offset":9956},"end":{"line":221,"column":4,"offset":10109}}}],"position":{"start":{"line":210,"column":1,"offset":9956},"end":{"line":221,"column":4,"offset":10109}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Normally, when a document is unloaded, all associated network requests are aborted. But the ","position":{"start":{"line":223,"column":1,"offset":10111},"end":{"line":223,"column":93,"offset":10203}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"keepalive"}],"position":{"start":{"line":223,"column":93,"offset":10203},"end":{"line":223,"column":104,"offset":10214}}},{"type":"text","value":" option tells the browser to perform the request in the background, even after it leaves the page. So this option is essential for our request to succeed.","position":{"start":{"line":223,"column":104,"offset":10214},"end":{"line":223,"column":258,"offset":10368}}}],"position":{"start":{"line":223,"column":1,"offset":10111},"end":{"line":223,"column":258,"offset":10368}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"It has a few limitations:","position":{"start":{"line":225,"column":1,"offset":10370},"end":{"line":225,"column":26,"offset":10395}}}],"position":{"start":{"line":225,"column":1,"offset":10370},"end":{"line":225,"column":26,"offset":10395}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"We can't send megabytes: the body limit for ","position":{"start":{"line":227,"column":5,"offset":10401},"end":{"line":227,"column":49,"offset":10445}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"keepalive"}],"position":{"start":{"line":227,"column":49,"offset":10445},"end":{"line":227,"column":60,"offset":10456}}},{"type":"text","value":" requests is 64KB.","position":{"start":{"line":227,"column":60,"offset":10456},"end":{"line":227,"column":78,"offset":10474}}}],"position":{"start":{"line":227,"column":5,"offset":10401},"end":{"line":227,"column":78,"offset":10474}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"If we need to gather a lot of statistics about the visit, we should send it out regularly in packets, so that there won't be a lot left for the last ","position":{"start":{"line":228,"column":9,"offset":10483},"end":{"line":228,"column":158,"offset":10632}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"onunload"}],"position":{"start":{"line":228,"column":158,"offset":10632},"end":{"line":228,"column":168,"offset":10642}}},{"type":"text","value":" request.","position":{"start":{"line":228,"column":168,"offset":10642},"end":{"line":228,"column":177,"offset":10651}}}],"position":{"start":{"line":228,"column":5,"offset":10479},"end":{"line":228,"column":177,"offset":10651}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"This limit applies to all ","position":{"start":{"line":229,"column":9,"offset":10660},"end":{"line":229,"column":35,"offset":10686}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"keepalive"}],"position":{"start":{"line":229,"column":35,"offset":10686},"end":{"line":229,"column":46,"offset":10697}}},{"type":"text","value":" requests together. In other words, we can perform multiple ","position":{"start":{"line":229,"column":46,"offset":10697},"end":{"line":229,"column":106,"offset":10757}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"keepalive"}],"position":{"start":{"line":229,"column":106,"offset":10757},"end":{"line":229,"column":117,"offset":10768}}},{"type":"text","value":" requests in parallel, but the sum of their body lengths should not exceed 64KB.","position":{"start":{"line":229,"column":117,"offset":10768},"end":{"line":229,"column":197,"offset":10848}}}],"position":{"start":{"line":229,"column":5,"offset":10656},"end":{"line":229,"column":197,"offset":10848}}},{"type":"text","value":"\n"}],"position":{"start":{"line":228,"column":5,"offset":10479},"end":{"line":229,"column":197,"offset":10848}}},{"type":"text","value":"\n"}],"position":{"start":{"line":227,"column":1,"offset":10397},"end":{"line":229,"column":197,"offset":10848}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"We can't handle the server response if the document is unloaded. So in our example ","position":{"start":{"line":230,"column":5,"offset":10853},"end":{"line":230,"column":88,"offset":10936}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"fetch"}],"position":{"start":{"line":230,"column":88,"offset":10936},"end":{"line":230,"column":95,"offset":10943}}},{"type":"text","value":" will succeed due to ","position":{"start":{"line":230,"column":95,"offset":10943},"end":{"line":230,"column":116,"offset":10964}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"keepalive"}],"position":{"start":{"line":230,"column":116,"offset":10964},"end":{"line":230,"column":127,"offset":10975}}},{"type":"text","value":", but subsequent functions won't work.","position":{"start":{"line":230,"column":127,"offset":10975},"end":{"line":230,"column":165,"offset":11013}}}],"position":{"start":{"line":230,"column":5,"offset":10853},"end":{"line":230,"column":165,"offset":11013}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"In most cases, such as sending out statistics, it's not a problem, as the server just accepts the data and usually sends an empty response to such requests.","position":{"start":{"line":231,"column":9,"offset":11022},"end":{"line":231,"column":165,"offset":11178}}}],"position":{"start":{"line":231,"column":5,"offset":11018},"end":{"line":231,"column":165,"offset":11178}}},{"type":"text","value":"\n"}],"position":{"start":{"line":231,"column":5,"offset":11018},"end":{"line":231,"column":165,"offset":11178}}},{"type":"text","value":"\n"}],"position":{"start":{"line":230,"column":1,"offset":10849},"end":{"line":231,"column":165,"offset":11178}}},{"type":"text","value":"\n"}],"position":{"start":{"line":227,"column":1,"offset":10397},"end":{"line":231,"column":165,"offset":11178}}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":232,"column":1,"offset":11179}}}}